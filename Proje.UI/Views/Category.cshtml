@model Category
@
{

    ViewData
[
"Title"
]
 
=
 Model
.
Name
;

}


<div class="container mt-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Ana Sayfa</a></li>
            <li class="breadcrumb-item active" aria-current="page">@Model.Name</li>
        </ol>
    </nav>
    
    <h1 class="mb-4">@Model.Name</h1>
    
    
@if
 
(
!
string
.
IsNullOrEmpty
(
Model
.
Description
)
)

    
{

        
<
div
 
class
=
"
mb-4
"
>

            
<
p
>
@
Model
.
Description
</
p
>

        
</
div
>

    
}

    
    <div class="row">
        
@if
 
(
Model
.
Products 
!=
 
null
 
&&
 Model
.
Products
.
Any
(
)
)

        
{

            @
foreach
 
(
var
 product 
in
 Model
.
Products
)

            
{

                
<
div
 
class
=
"
col-md-4 mb-4
"
>

                    
<
div
 
class
=
"
card h-100
"
>

                        
<
img
 src
=
"@(string.IsNullOrEmpty(product.ImageUrl) ? "
/
img
/
no
-
image
.
jpg
" : product.ImageUrl)"
 
                             
class
=
"card-img-top"
 alt
=
"@product.Name"
 style
=
"height: 200px; object-fit: cover;"
>

                        
<
div
 
class
=
"
card-body
"
>

                            
<
h5
 
class
=
"
card-title
"
>
@
product
.
Name
</
h5
>

                            
<
p
 
class
=
"
card-text
"
>
@
(
product
.
Description
.
Length 
>
 
100
 
?
 product
.
Description
.
Substring
(
0
,
 
100
)
 
+
 
"..."
 
:
 product
.
Description
)
</
p
>

                            
<
h6
 
class
=
"
card-subtitle mb-2 text-primary
"
>
@
product
.
Price
.
ToString
(
"C"
)
</
h6
>

                            
<
a
 
href
=
"
@Url.Action(
"
Detail",
 
"Home",
 
new
 
{
 
id
 
=
 product.Id
 
})"
 
class
=
"
btn btn-outline-primary
"
>
Detay
</
a
>

                            
<
button
 
class
=
"
btn btn-success add-to-cart
"
 
data-product-id
=
"
@product.Id
"
>
Sepete Ekle
</
button
>

                        
</
div
>

                    
<
/
div
>

                
<
/
div
>

            
}

        
}

        
else

        
{

            
<
div
 
class
=
"
col-12
"
>

                
<
div
 
class
=
"
alert alert-info
"
>

                    Bu kategoride ürün bulunamadı.
                
</
div
>

            
</
div
>

        
}

    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Sepete ekle
            $(document).on("click", ".add-to-cart", function() {
                var productId = $(this).data("product-id");
                
                $.ajax({
                    url: '@Url.Action("AddToCart", "Home")',
                    type: 'POST',
                    data: { productId: productId, quantity: 1 },
                    success: function(response) {
                        if (response.success) {
                            alert(response.message);
                            // Sepet sayacını güncelle
                            $("#cartItemCount").text(response.cartItemCount);
                        } else {
                            alert(response.message);
                        }
                    },
                    error: function() {
                        alert("İşlem sırasında bir hata oluştu.");
                    }
                });
            });
        });
    </script>
}
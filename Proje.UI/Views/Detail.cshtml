@model Product
@
{

    ViewData
[
"Title"
]
 
=
 Model
.
Name
;

}


<div class="container mt-4">
    <div class="row">
        <div class="col-md-5">
            <img src="@(string.IsNullOrEmpty(Model.ImageUrl) ? "/img/no-image.jpg" : Model.ImageUrl)" 
                 class="img-fluid rounded" alt="@Model.Name">
        </div>
        <div class="col-md-7">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Ana Sayfa</a></li>
                    <li class="breadcrumb-item"><a href="@Url.Action("Category", "Home", new { id = Model.CategoryId })">@Model.Category.Name</a></li>
                    <li class="breadcrumb-item active" aria-current="page">@Model.Name</li>
                </ol>
            </nav>
            
            <h1 class="mb-3">@Model.Name</h1>
            
            <p class="text-muted">Kategori: @Model.Category.Name</p>
            
            <div class="mb-3">
                <h3 class="text-primary">@Model.Price.ToString("C")</h3>
            </div>
            
            <div class="mb-4">
                <p>@Model.Description</p>
            </div>
            
            <div class="mb-3">
                <p class="mb-1">Stok Durumu:</p>
                
@if
 
(
Model
.
Stock 
>
 
0
)

                
{

                    
<
span
 
class
=
"
badge bg-success
"
>
Stokta var (
@
Model
.
Stock
 adet)
</
span
>

                
}

                
else

                
{

                    
<
span
 
class
=
"
badge bg-danger
"
>
Stokta yok
</
span
>

                
}

            </div>
            
            <div class="d-flex align-items-center mb-4">
                <div class="input-group me-3" style="width: 120px;">
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="decreaseQuantity">-</button>
                    <input type="number" id="quantity" class="form-control text-center" value="1" min="1" max="@Model.Stock">
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="increaseQuantity">+</button>
                </div>
                
                <button id="addToCartBtn" class="btn btn-primary btn-lg" data-product-id="@Model.Id">
                    <i class="bi bi-cart-plus"></i> Sepete Ekle
                </button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Miktar artırma ve azaltma
            $("#increaseQuantity").click(function() {
                var value = parseInt($("#quantity").val());
                var max = parseInt($("#quantity").attr("max"));
                
                if (value < max) {
                    $("#quantity").val(value + 1);
                }
            });
            
            $("#decreaseQuantity").click(function() {
                var value = parseInt($("#quantity").val());
                
                if (value > 1) {
                    $("#quantity").val(value - 1);
                }
            });
            
            // Sepete ekle
            $("#addToCartBtn").click(function() {
                var productId = $(this).data("product-id");
                var quantity = parseInt($("#quantity").val());
                
                $.ajax({
                    url: '@Url.Action("AddToCart", "Home")',
                    type: 'POST',
                    data: { productId: productId, quantity: quantity },
                    success: function(response) {
                        if (response.success) {
                            alert(response.message);
                            // Sepet sayacını güncelle
                            $("#cartItemCount").text(response.cartItemCount);
                        } else {
                            alert(response.message);
                        }
                    },
                    error: function() {
                        alert("İşlem sırasında bir hata oluştu.");
                    }
                });
            });
        });
    </script>
}